

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชุฌุฏูุฏ ุงูุงุดุชุฑุงูุงุช - ูุธุงู ุฅุฏุงุฑุฉ ุงูุฌูู</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <!-- ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-dumbbell"></i>
                    </div>
                    <h1>GYM <span>MANAGER</span></h1>
                </div>
                <button class="sidebar-close" id="sidebarClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="sidebar-profile">
                <div class="profile-img">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=0f4c75&color=fff" alt="ุตูุฑุฉ ุงููุณุชุฎุฏู">
                </div>
                <div class="profile-info">
                    <h3 id="userName">ุงููุณุคูู ุงูุฑุฆูุณู</h3>
                    <p id="userRole">ูุณุคูู</p>
                    <span class="status online" id="userStatus">ูุชุตู</span>
                </div>
            </div>
            
            <nav class="sidebar-menu">
                <ul>
                    <li>
                        <a href="dashboard.html">
                            <i class="fas fa-home"></i>
                            <span>ููุญุฉ ุงูุชุญูู</span>
                        </a>
                    </li>
                    <li>
                        <a href="members.html">
                            <i class="fas fa-users"></i>
                            <span>ุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="renew.html">
                            <i class="fas fa-redo"></i>
                            <span>ุชุฌุฏูุฏ ุงูุงุดุชุฑุงูุงุช</span>
                        </a>
                    </li>
                    <li>
                        <a href="calendar.html">
                            <i class="fas fa-calendar-alt"></i>
                            <span>ุงูุชูููู ูุงูุงุดุชุฑุงูุงุช</span>
                        </a>
                    </li>
                    <li>
                        <a href="subscriptions.html">
                            <i class="fas fa-credit-card"></i>
                            <span>ุงูุงุดุชุฑุงูุงุช</span>
                        </a>
                    </li>
                    <li>
                        <a href="settings.html">
                            <i class="fas fa-cog"></i>
                            <span>ุงูุฅุนุฏุงุฏุงุช</span>
                        </a>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <button class="btn-logout" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>ุชุณุฌูู ุงูุฎุฑูุฌ</span>
                </button>
            </div>
        </aside>
        
        <!-- ุทุจูุฉ ุงูุชุนุชูู ูููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        
        <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
        <main class="main-content">
            <!-- ุดุฑูุท ุงูุฑุฃุณ ุงูุนููู -->
            <header class="top-header">
                <div class="header-left">
                    <button class="sidebar-toggle" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchInput" placeholder="ุงุจุญุซ ุนู ุนุถู ููุชุฌุฏูุฏ...">
                        <button class="clear-search" id="clearSearchBtn">
                            <i class="fas fa-times"></i>
                        </button>
                        <button class="search-btn" id="searchBtn">ุจุญุซ</button>
                    </div>
                    <div class="search-results" id="searchResults"></div>
                </div>
                
                <div class="header-right">
                    <button class="notifications-btn" id="notificationsBtn">
                        <i class="fas fa-bell"></i>
                        <span class="notification-count" id="notificationCount">0</span>
                    </button>
                    
                    <div class="user-menu">
                        <div class="user-info">
                            <span id="headerUserName">ุงููุณุคูู ุงูุฑุฆูุณู</span>
                            <small>ูุณุคูู</small>
                        </div>
                        <div class="user-avatar">
                            <img src="https://ui-avatars.com/api/?name=Admin&background=0f4c75&color=fff" alt="ุตูุฑุฉ ุงููุณุชุฎุฏู">
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- ูุญุชูู ุตูุญุฉ ุชุฌุฏูุฏ ุงูุงุดุชุฑุงูุงุช -->
            <div class="dashboard-content">
                <div class="page-header">
                    <h2>ุชุฌุฏูุฏ ุงูุงุดุชุฑุงูุงุช</h2>
                    <p>ุฅุฏุงุฑุฉ ูุชุฌุฏูุฏ ุงุดุชุฑุงูุงุช ุงูุนููุงุก ุงูููุชููุฉ ุฃู ุงููููููุฉ</p>
                </div>
                
                <!-- ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="fas fa-calendar-times"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="expiredCount">0</h3>
                            <p>ุงุดุชุฑุงูุงุช ููุชููุฉ</p>
                        </div>
                        <button class="stat-link" id="viewExpiredBtn">ุนุฑุถ ุงููู</button>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon warning">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="expiringSoonCount">0</h3>
                            <p>ุชูุชูู ุฎูุงู ุฃุณุจูุน</p>
                        </div>
                        <button class="stat-link" id="viewExpiringBtn">ุนุฑุถ ุงููู</button>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-times"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="suspendedCount">0</h3>
                            <p>ุงุดุชุฑุงูุงุช ูููููุฉ</p>
                        </div>
                        <button class="stat-link" id="viewSuspendedBtn">ุนุฑุถ ุงููู</button>
                    </div>
                    
                    <div class="stat-card success">
                        <div class="stat-icon">
                            <i class="fas fa-redo"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="renewedThisMonth">0</h3>
                            <p>ุชู ุชุฌุฏูุฏูุง ูุฐุง ุงูุดูุฑ</p>
                        </div>
                        <button class="stat-link" id="viewRenewedBtn">ุนุฑุถ ุงููู</button>
                    </div>
                </div>
                
                <!-- ููุชุฑุฉ ูุชูุฏูุฉ -->
                
                <!-- ุฃุฒุฑุงุฑ ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ -->
                <div class="quick-actions-bar">
                    <button class="btn-primary" id="renewSelectedBtn" disabled>
                        <i class="fas fa-redo"></i> ุชุฌุฏูุฏ ุงููุญุฏุฏูู <span class="selected-count">(0)</span>
                    </button>
                    <button class="btn-secondary" id="sendRemindersBtn">
                        <i class="fas fa-bell"></i> ุฅุฑุณุงู ุชุฐููุฑุงุช
                    </button>
                 
                    <button class="btn-secondary" id="printListBtn">
                        <i class="fas fa-print"></i> ุทุจุงุนุฉ ุงููุงุฆูุฉ
                    </button>
                </div>
                
                <!-- ุฌุฏูู ุงูุนููุงุก ููุชุฌุฏูุฏ -->
                <div class="table-container">
                    <div class="table-header">
                        <h3>ุงูุนููุงุก ุงููุทููุจ ุชุฌุฏูุฏ ุงุดุชุฑุงูุงุชูู</h3>
                        <div class="table-actions">
                            <span id="renewCount">0 ุนููู</span>
                            <div class="selection-buttons">
                                <button class="btn-secondary" id="selectAllBtn">
                                    <i class="fas fa-check-square"></i> ุชุญุฏูุฏ ุงููู
                                </button>
                                <button class="btn-secondary" id="deselectAllBtn">
                                    <i class="far fa-square"></i> ุฅูุบุงุก ุงููู
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="renew-table" id="renewTable">
                            <thead>
                                <tr>
                                    <th width="50">
                                        <input type="checkbox" id="selectAllCheckbox">
                                    </th>
                                    <th width="100">ููุฏ ุงูุนุถู</th>
                                    <th>ุงุณู ุงูุนุถู</th>
                                    <th width="120">ุงููุงุชู</th>
                                    <th width="120">ุงูุจุงูุฉ ุงูุญุงููุฉ</th>
                                    <th width="120">ุชุงุฑูุฎ ุงูุจุฏุก</th>
                                    <th width="120">ุชุงุฑูุฎ ุงูุงูุชูุงุก</th>
                                    <th width="100">ุงูุฃูุงู ุงููุชุจููุฉ</th>
                                    <th width="100">ุงูุญุงูุฉ</th>
                                    <th width="120">ุงูุฅุฌุฑุงุกุงุช</th>
                                </tr>
                            </thead>
                            <tbody id="renewTableBody">
                                <!-- ุณูุชู ููุคู ุจูุงุณุทุฉ JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="table-footer">
                        <div class="pagination">
                            <button class="pagination-btn" id="prevPageBtn" disabled>
                                <i class="fas fa-chevron-right"></i>
                            </button>
                            <span class="page-numbers">
                                <span class="current-page">1</span> ูู <span class="total-pages">1</span>
                            </span>
                            <button class="pagination-btn" id="nextPageBtn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                        </div>
                        
                        <div class="rows-per-page">
                            <span>ุนุฑุถ</span>
                            <select id="rowsPerPage">
                                <option value="10">10</option>
                                <option value="25" selected>25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                            <span>ุตู ูู ูู ุตูุญุฉ</span>
                        </div>
                    </div>
                </div>
                
                <!-- ุงูุนููุงุก ุงููุฌุฏุฏูู ูุคุฎุฑุงู -->
                <div class="recent-renewals">
                    <div class="section-header">
                        <h3>ุขุฎุฑ ุงูุชุฌุฏูุฏุงุช</h3>
                        <button class="btn-secondary" id="viewAllRenewalsBtn">ุนุฑุถ ุฌููุน ุงูุชุฌุฏูุฏุงุช</button>
                    </div>
                    <div class="renewals-list" id="renewalsList">
                        <!-- ุณูุชู ููุคู ุจูุงุณุทุฉ JavaScript -->
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- ูููุฐุฌ ุงูุชุฌุฏูุฏ ุงููุฑุฏู -->
    <div id="renewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ุชุฌุฏูุฏ ุงุดุชุฑุงู ุงูุนุถู</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="renewForm">
                    <!-- ูุนูููุงุช ุงูุนุถู -->
                    <div class="member-info-section">
                        <h4>ูุนูููุงุช ุงูุนุถู</h4>
                        <div class="member-info-grid">
                            <div class="info-item">
                                <span>ุงูุงุณู:</span>
                                <strong id="renewMemberName">-</strong>
                            </div>
                            <div class="info-item">
                                <span>ุงูููุฏ:</span>
                                <strong id="renewMemberCode">-</strong>
                            </div>
                            <div class="info-item">
                                <span>ุงููุงุชู:</span>
                                <strong id="renewMemberPhone">-</strong>
                            </div>
                            <div class="info-item">
                                <span>ุงูุจุงูุฉ ุงูุณุงุจูุฉ:</span>
                                <strong id="renewOldPackage">-</strong>
                            </div>
                            <div class="info-item">
                                <span>ุชุงุฑูุฎ ุงูุงูุชูุงุก:</span>
                                <strong id="renewOldEndDate">-</strong>
                            </div>
                            <div class="info-item">
                                <span>ุงูุญุงูุฉ:</span>
                                <strong id="renewMemberStatus">-</strong>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ุชูุงุตูู ุงูุชุฌุฏูุฏ -->
                    <div class="renew-details-section">
                        <h4>ุชูุงุตูู ุงูุชุฌุฏูุฏ</h4>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="renewPackage">ุงูุจุงูุฉ ุงูุฌุฏูุฏุฉ *</label>
                                <select id="renewPackage" required>
                                    <option value="">ุงุฎุชุฑ ุงูุจุงูุฉ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="renewDuration">ุงููุฏุฉ (ุฃุดูุฑ) *</label>
                                <select id="renewDuration" required>
                                    <option value="1">ุดูุฑ ูุงุญุฏ</option>
                                    <option value="3">3 ุฃุดูุฑ</option>
                                    <option value="6">6 ุฃุดูุฑ</option>
                                    <option value="12">12 ุดูุฑ</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="renewStartDate">ุชุงุฑูุฎ ุงูุจุฏุก *</label>
                                <input type="date" id="renewStartDate" required>
                            </div>
                            <div class="form-group">
                                <label for="renewEndDate">ุชุงุฑูุฎ ุงูุงูุชูุงุก</label>
                                <input type="date" id="renewEndDate" readonly>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="renewPrice">ุงูุณุนุฑ (ุฌ.ู) *</label>
                                <input type="number" id="renewPrice" min="0" required>
                            </div>
                            <div class="form-group">
                                <label for="renewDiscount">ุงูุฎุตู (ุฌ.ู)</label>
                                <input type="number" id="renewDiscount" min="0" value="0">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="renewFinalPrice">ุงููุจูุบ ุงูููุงุฆู (ุฌ.ู)</label>
                            <input type="number" id="renewFinalPrice" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="renewPaymentMethod">ุทุฑููุฉ ุงูุฏูุน *</label>
                            <select id="renewPaymentMethod" required>
                                <option value="">ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน</option>
                                <option value="ูุงุด">ูุงุด</option>
                                <option value="ููุฏุงููู ูุงุด">ููุฏุงููู ูุงุด</option>
                                <option value="ุงูุณุชุง ุจุงู">ุงูุณุชุง ุจุงู</option>
                                <option value="ุจุทุงูุฉ ุงุฆุชูุงู">ุจุทุงูุฉ ุงุฆุชูุงู</option>
                            </select>
                        </div>
                        
                        <div class="payment-summary">
                            <h5>ููุฎุต ุงูุฏูุน</h5>
                            <div class="summary-item">
                                <span>ุณุนุฑ ุงูุจุงูุฉ:</span>
                                <span id="summaryPackagePrice">0 ุฌ.ู</span>
                            </div>
                            <div class="summary-item">
                                <span>ุงูุฎุตู:</span>
                                <span id="summaryDiscount">0 ุฌ.ู</span>
                            </div>
                            <div class="summary-item total">
                                <span>ุงููุจูุบ ุงููุณุชุญู:</span>
                                <span id="summaryTotal">0 ุฌ.ู</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="renewNotes">ููุงุญุธุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)</label>
                            <textarea id="renewNotes" rows="3" placeholder="ุฃุฏุฎู ุฃู ููุงุญุธุงุช ุฅุถุงููุฉ"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-check-circle"></i> ุชุฃููุฏ ุงูุชุฌุฏูุฏ
                        </button>
                        <button type="button" class="btn-secondary close-modal">ุฅูุบุงุก</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- ูููุฐุฌ ุงูุชุฌุฏูุฏ ุงูุฌูุงุนู -->
    <div id="bulkRenewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ุชุฌุฏูุฏ ุงุดุชุฑุงูุงุช ูุชุนุฏุฏุฉ</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="bulkRenewForm">
                    <div class="bulk-info">
                        <div class="info-message">
                            <i class="fas fa-users"></i>
                            <div>
                                <h4>ุณูุชู ุชุฌุฏูุฏ <span id="bulkMembersCount">0</span> ุนุถู</h4>
                                <p>ุณูุชู ุชุทุจูู ููุณ ุฅุนุฏุงุฏุงุช ุงูุชุฌุฏูุฏ ุนูู ุฌููุน ุงูุฃุนุถุงุก ุงููุญุฏุฏูู</p>
                            </div>
                        </div>
                        
                        <div class="selected-members-list" id="bulkMembersList">
                            <!-- ุณูุชู ููุคู ุจูุงุณุทุฉ JavaScript -->
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bulkRenewPackage">ุงูุจุงูุฉ ุงูุฌุฏูุฏุฉ *</label>
                        <select id="bulkRenewPackage" required>
                            <option value="">ุงุฎุชุฑ ุงูุจุงูุฉ</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="bulkRenewDuration">ุงููุฏุฉ (ุฃุดูุฑ) *</label>
                            <select id="bulkRenewDuration" required>
                                <option value="1">ุดูุฑ ูุงุญุฏ</option>
                                <option value="3">3 ุฃุดูุฑ</option>
                                <option value="6">6 ุฃุดูุฑ</option>
                                <option value="12">12 ุดูุฑ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="bulkRenewPrice">ุงูุณุนุฑ ููู ุนุถู (ุฌ.ู) *</label>
                            <input type="number" id="bulkRenewPrice" min="0" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bulkRenewPaymentMethod">ุทุฑููุฉ ุงูุฏูุน *</label>
                        <select id="bulkRenewPaymentMethod" required>
                            <option value="">ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน</option>
                            <option value="ูุงุด">ูุงุด</option>
                            <option value="ููุฏุงููู ูุงุด">ููุฏุงููู ูุงุด</option>
                            <option value="ุงูุณุชุง ุจุงู">ุงูุณุชุง ุจุงู</option>
                            <option value="ุจุทุงูุฉ ุงุฆุชูุงู">ุจุทุงูุฉ ุงุฆุชูุงู</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="bulkRenewStartDate">ุชุงุฑูุฎ ุงูุจุฏุก *</label>
                        <input type="date" id="bulkRenewStartDate" required>
                    </div>
                    
                    <div class="bulk-summary">
                        <h5>ููุฎุต ุงูุชุฌุฏูุฏ ุงูุฌูุงุนู</h5>
                        <div class="summary-item">
                            <span>ุนุฏุฏ ุงูุฃุนุถุงุก:</span>
                            <span id="bulkSummaryCount">0</span>
                        </div>
                        <div class="summary-item">
                            <span>ุณุนุฑ ุงูุนุถู ุงููุงุญุฏ:</span>
                            <span id="bulkSummaryPrice">0 ุฌ.ู</span>
                        </div>
                        <div class="summary-item total">
                            <span>ุงููุจูุบ ุงูุฅุฌูุงูู:</span>
                            <span id="bulkSummaryTotal">0 ุฌ.ู</span>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-check-circle"></i> ุชุฃููุฏ ุงูุชุฌุฏูุฏ ุงูุฌูุงุนู
                        </button>
                        <button type="button" class="btn-secondary close-modal">ุฅูุบุงุก</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- ูููุฐุฌ ุฅุฑุณุงู ุชุฐููุฑุงุช -->
    <div id="remindersModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ุฅุฑุณุงู ุชุฐููุฑุงุช ููุนููุงุก</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="remindersForm">
                    <div class="form-group">
                        <label for="reminderType">ููุน ุงูุชุฐููุฑ</label>
                        <select id="reminderType">
                            <option value="expired">ููุนููุงุก ุงูููุชููุฉ ุงุดุชุฑุงูุงุชูู</option>
                            <option value="expiring-soon">ููุนููุงุก ุนูู ูุดู ุงูุงูุชูุงุก (7 ุฃูุงู)</option>
                            <option value="all">ุฌููุน ุงูุนููุงุก ูู ุงููุงุฆูุฉ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>ุทุฑููุฉ ุงูุฅุฑุณุงู</label>
                        <div class="method-options">
                            <label class="checkbox-option">
                                <input type="checkbox" id="reminderWhatsApp" checked>
                                <span class="checkmark"></span>
                                <span class="method-label">
                                    <i class="fab fa-whatsapp"></i>
                                    <span>ูุงุชุณุงุจ</span>
                                </span>
                            </label>
                            
                            <label class="checkbox-option">
                                <input type="checkbox" id="reminderSMS">
                                <span class="checkmark"></span>
                                <span class="method-label">
                                    <i class="fas fa-sms"></i>
                                    <span>ุฑุณุงุฆู SMS</span>
                                </span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="reminderMessage">ูุต ุงูุฑุณุงูุฉ</label>
                        <textarea id="reminderMessage" rows="4" placeholder="ุฃุฏุฎู ูุต ุงูุฑุณุงูุฉ...">
ุนุฒูุฒู/ุนุฒูุฒุชู {ุงุณู_ุงูุนุถู}ุ
ููุฏ ุชุฐููุฑู ุจุฃู ุงุดุชุฑุงูู ูู ุงููุงุฏู {ุญุงูุฉ_ุงูุงุดุชุฑุงู}.
ูุฑุฌู ุฒูุงุฑุฉ ุงููุงุฏู ูุชุฌุฏูุฏ ุงุดุชุฑุงูู.
ูุน ุฎุงูุต ุงูุชุญูุฉุ
ุฅุฏุงุฑุฉ ุงููุงุฏู
                        </textarea>
                        <small class="hint">ููููู ุงุณุชุฎุฏุงู ุงููุชุบูุฑุงุช: {ุงุณู_ุงูุนุถู}, {ุญุงูุฉ_ุงูุงุดุชุฑุงู}, {ุชุงุฑูุฎ_ุงูุงูุชูุงุก}</small>
                    </div>
                    
                    <div class="recipients-list">
                        <h5>ูุงุฆูุฉ ุงููุณุชูููู</h5>
                        <div class="recipients-count">
                            <span id="recipientsCount">0</span> ุนููู
                        </div>
                        <div class="recipients-preview" id="recipientsPreview">
                            <!-- ุณูุชู ููุคู ุจูุงุณุทุฉ JavaScript -->
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-paper-plane"></i> ุฅุฑุณุงู ุงูุชุฐููุฑุงุช
                        </button>
                        <button type="button" class="btn-secondary close-modal">ุฅูุบุงุก</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <script src="data.js"></script>
    <script src="script.js"></script>
    <script>
    /**
     * ุณูุฑูุจุช ุฎุงุต ุจุตูุญุฉ ุชุฌุฏูุฏ ุงูุงุดุชุฑุงูุงุช
     */
    
    // ูุชุบูุฑุงุช ุงูุตูุญุฉ
    let renewCurrentPage = 1;
    let renewRowsPerPage = 25;
    let renewFilteredMembers = [];
    let selectedRenewMembers = new Set();
    
    // ุชููุฆุฉ ุตูุญุฉ ุงูุชุฌุฏูุฏ
    function initRenewPage() {
        // ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
        updateRenewStats();
        
        // ุชุญููู ุงูุฃุนุถุงุก
        loadRenewMembers();
        
        // ุชููุฆุฉ ุงูุฃุญุฏุงุซ
        initRenewEvents();
        
        // ุชุนุจุฆุฉ ุฎูุงุฑุงุช ุงูุจุงูุงุช
        fillPackageOptions();
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงูุชุฌุฏูุฏ
    function updateRenewStats() {
        const today = new Date();
        const weekFromNow = new Date();
        weekFromNow.setDate(today.getDate() + 7);
        
        // ุงูุฃุนุถุงุก ุงูููุชููุฉ ุงุดุชุฑุงูุงุชูู
        const expiredMembers = subscriptions.filter(member => {
            if (member.status !== 'active') return false;
            const endDate = new Date(member.endDate);
            return endDate < today;
        });
        
        // ุงูุฃุนุถุงุก ุนูู ูุดู ุงูุงูุชูุงุก
        const expiringSoonMembers = subscriptions.filter(member => {
            if (member.status !== 'active') return false;
            const endDate = new Date(member.endDate);
            return endDate >= today && endDate <= weekFromNow;
        });
        
        // ุงูุฃุนุถุงุก ุงูููููููู
        const suspendedMembers = subscriptions.filter(member => 
            member.status === 'suspended'
        );
        
        // ุงูุฃุนุถุงุก ุงููุฌุฏุฏูู ูุฐุง ุงูุดูุฑ
        const currentMonth = new Date().getMonth() + 1;
        const renewedThisMonth = activities.filter(activity => {
            if (activity.type !== 'ุชุฌุฏูุฏ ุงุดุชุฑุงู') return false;
            const activityDate = new Date(activity.date);
            return activityDate.getMonth() + 1 === currentMonth;
        });
        
        // ุชุญุฏูุซ ุงูุนุฏุงุฏุงุช
        document.getElementById('expiredCount').textContent = expiredMembers.length;
        document.getElementById('expiringSoonCount').textContent = expiringSoonMembers.length;
        document.getElementById('suspendedCount').textContent = suspendedMembers.length;
        document.getElementById('renewedThisMonth').textContent = renewedThisMonth.length;
    }
    
    // ุฏุงูุฉ ุชุญููู ุงูุฃุนุถุงุก ููุชุฌุฏูุฏ
    function loadRenewMembers() {
        const filterStatus = document.getElementById('filterStatus').value;
        const filterPackage = document.getElementById('filterPackage').value;
        const filterDuration = document.getElementById('filterDuration').value;
        const filterSort = document.getElementById('filterSort').value;
        
        // ุชุทุจูู ุงูููุชุฑุฉ
        let members = applyRenewFilter(filterStatus);
        
        // ููุชุฑุฉ ุญุณุจ ุงูุจุงูุฉ
        if (filterPackage !== 'all') {
            members = members.filter(member => member.package === filterPackage);
        }
        
        // ููุชุฑุฉ ุญุณุจ ุงููุชุฑุฉ
        if (filterDuration !== 'all') {
            members = applyDurationFilter(members, filterDuration);
        }
        
        // ุงูุชุฑุชูุจ
        members = sortMembers(members, filterSort);
        
        // ุญูุธ ุงููุชุงุฆุฌ
        renewFilteredMembers = members;
        
        // ุนุฑุถ ุงูุฃุนุถุงุก
        renderRenewTable();
        
        // ุชุญุฏูุซ ุงูุชุฑุญูู
        updateRenewPagination();
        
        // ุชุญุฏูุซ ุงูุนุฏุงุฏ
        document.getElementById('renewCount').textContent = `${members.length} ุนููู`;
    }
    
    // ุฏุงูุฉ ุชุทุจูู ููุชุฑุฉ ุงูุญุงูุฉ
    function applyRenewFilter(filterType) {
        const today = new Date();
        
        switch(filterType) {
            case 'expired':
                return subscriptions.filter(member => {
                    if (member.status !== 'active') return false;
                    const endDate = new Date(member.endDate);
                    return endDate < today;
                });
                
            case 'expiring-soon':
                const weekFromNow = new Date();
                weekFromNow.setDate(today.getDate() + 7);
                
                return subscriptions.filter(member => {
                    if (member.status !== 'active') return false;
                    const endDate = new Date(member.endDate);
                    return endDate >= today && endDate <= weekFromNow;
                });
                
            case 'suspended':
                return subscriptions.filter(member => member.status === 'suspended');
                
            default:
                // ุฌููุน ุงูุฃุนุถุงุก ุงูุฐูู ูุญุชุงุฌูู ุชุฌุฏูุฏ
                return subscriptions.filter(member => 
                    member.status === 'active' || member.status === 'suspended'
                );
        }
    }
    
    // ุฏุงูุฉ ุชุทุจูู ููุชุฑุฉ ุงููุชุฑุฉ
    function applyDurationFilter(members, duration) {
        const today = new Date();
        const startDate = new Date();
        
        switch(duration) {
            case 'today':
                return members.filter(member => {
                    const endDate = new Date(member.endDate);
                    return endDate.toDateString() === today.toDateString();
                });
                
            case 'week':
                startDate.setDate(today.getDate() - 7);
                return members.filter(member => {
                    const endDate = new Date(member.endDate);
                    return endDate >= startDate && endDate <= today;
                });
                
            case 'month':
                startDate.setMonth(today.getMonth() - 1);
                return members.filter(member => {
                    const endDate = new Date(member.endDate);
                    return endDate >= startDate && endDate <= today;
                });
                
            default:
                return members;
        }
    }
    
    // ุฏุงูุฉ ุชุฑุชูุจ ุงูุฃุนุถุงุก
    function sortMembers(members, sortType) {
        const sorted = [...members];
        
        sorted.sort((a, b) => {
            switch(sortType) {
                case 'recent':
                    return new Date(b.endDate) - new Date(a.endDate);
                    
                case 'oldest':
                    return new Date(a.endDate) - new Date(b.endDate);
                    
                case 'name':
                    return a.name.localeCompare(b.name);
                    
                case 'package':
                    return a.package.localeCompare(b.package);
                    
                default:
                    return 0;
            }
        });
        
        return sorted;
    }
    
    // ุฏุงูุฉ ุนุฑุถ ุฌุฏูู ุงูุชุฌุฏูุฏ
    function renderRenewTable() {
        const tbody = document.getElementById('renewTableBody');
        if (!tbody) return;
        
        // ุญุณุงุจ ุงูุจุฏุงูุฉ ูุงูููุงูุฉ ููุตูุญุฉ ุงูุญุงููุฉ
        const startIndex = (renewCurrentPage - 1) * renewRowsPerPage;
        const endIndex = startIndex + renewRowsPerPage;
        const pageMembers = renewFilteredMembers.slice(startIndex, endIndex);
        
        if (pageMembers.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="10" class="no-data">
                        <i class="fas fa-user-check"></i>
                        <p>ูุง ุชูุฌุฏ ุฃุนุถุงุก ูุญุชุงุฌูู ุชุฌุฏูุฏ</p>
                    </td>
                </tr>
            `;
            return;
        }
        
        let tableHtml = '';
        const today = new Date();
        
        pageMembers.forEach(member => {
            // ุญุณุงุจ ุงูุฃูุงู ุงููุชุจููุฉ
            const endDate = new Date(member.endDate);
            const daysRemaining = Math.ceil((endDate - today) / (1000 * 60 * 60 * 24));
            
            // ุชุญุฏูุฏ ุญุงูุฉ ุงูุนุถู
            let statusClass = '';
            let statusText = '';
            let daysClass = '';
            let daysText = '';
            
            if (member.status === 'suspended') {
                statusClass = 'suspended';
                statusText = 'ููููู';
                daysClass = 'suspended';
                daysText = 'ููููู';
            } else if (daysRemaining <= 0) {
                statusClass = 'expired';
                statusText = 'ููุชูู';
                daysClass = 'expired';
                daysText = 'ุงูุชูู';
            } else if (daysRemaining <= 7) {
                statusClass = 'warning';
                statusText = 'ููุชูู ูุฑูุจุงู';
                daysClass = 'warning';
                daysText = `${daysRemaining} ููู`;
            } else {
                statusClass = 'active';
                statusText = 'ูุดุท';
                daysClass = 'active';
                daysText = `${daysRemaining} ููู`;
            }
            
            // ุงูุชุญูู ุฅุฐุง ูุงู ูุญุฏุฏุงู
            const isSelected = selectedRenewMembers.has(member.id);
            
            tableHtml += `
                <tr data-id="${member.id}">
                    <td>
                        <input type="checkbox" class="renew-checkbox" 
                               data-id="${member.id}" ${isSelected ? 'checked' : ''}>
                    </td>
                    <td>
                        <span class="member-code">${member.id}</span>
                    </td>
                    <td>
                        <div class="member-name">
                            <div class="avatar">
                                ${member.gender === 'male' ? '๐จ' : '๐ฉ'}
                            </div>
                            <div>
                                <strong>${member.name}</strong>
                                <small>${member.age} ุณูุฉ</small>
                            </div>
                        </div>
                    </td>
                    <td>
                        <span class="member-phone">${member.phone}</span>
                    </td>
                    <td>
                        <span class="package-name">${member.package}</span>
                        <small>${member.price} ุฌ.ู</small>
                    </td>
                    <td>${formatDate(member.startDate)}</td>
                    <td>${formatDate(member.endDate)}</td>
                    <td>
                        <span class="days-remaining ${daysClass}">${daysText}</span>
                    </td>
                    <td>
                        <span class="status-badge ${statusClass}">${statusText}</span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-renew-single" data-id="${member.id}" 
                                    title="ุชุฌุฏูุฏ ูุฑุฏู">
                                <i class="fas fa-redo"></i>
                            </button>
                            <button class="btn-view-details" data-id="${member.id}" 
                                    title="ุนุฑุถ ุงูุชูุงุตูู">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        });
        
        tbody.innerHTML = tableHtml;
        
        // ุฅุถุงูุฉ ุงูุฃุญุฏุงุซ
        attachRenewTableEvents();
        
        // ุชุญุฏูุซ ุฒุฑ ุงูุชุฌุฏูุฏ ุงููุญุฏุฏูู
        updateRenewSelectedButton();
    }
    
    // ุฏุงูุฉ ุฅุถุงูุฉ ุงูุฃุญุฏุงุซ ูุฌุฏูู ุงูุชุฌุฏูุฏ
    function attachRenewTableEvents() {
        // ุตูุงุฏูู ุงูุชุญุฏูุฏ
        document.querySelectorAll('.renew-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const memberId = this.getAttribute('data-id');
                
                if (this.checked) {
                    selectedRenewMembers.add(memberId);
                } else {
                    selectedRenewMembers.delete(memberId);
                }
                
                updateSelectAllCheckbox();
                updateRenewSelectedButton();
            });
        });
        
        // ุฃุฒุฑุงุฑ ุงูุชุฌุฏูุฏ ุงููุฑุฏู
        document.querySelectorAll('.btn-renew-single').forEach(btn => {
            btn.addEventListener('click', function() {
                const memberId = this.getAttribute('data-id');
                const member = subscriptions.find(m => m.id === memberId);
                if (member) openRenewModal(member);
            });
        });
        
        // ุฃุฒุฑุงุฑ ุนุฑุถ ุงูุชูุงุตูู
        document.querySelectorAll('.btn-view-details').forEach(btn => {
            btn.addEventListener('click', function() {
                const memberId = this.getAttribute('data-id');
                // ูููู ูุชุญ ูููุฐุฌ ุชูุงุตูู ููุง
                showMemberDetails(memberId);
            });
        });
    }
    
    // ุฏุงูุฉ ุชููุฆุฉ ุฃุญุฏุงุซ ุตูุญุฉ ุงูุชุฌุฏูุฏ
    function initRenewEvents() {
        // ุฒุฑ ุนุฑุถ ุงูููุชููุฉ
        const viewExpiredBtn = document.getElementById('viewExpiredBtn');
        if (viewExpiredBtn) {
            viewExpiredBtn.addEventListener('click', () => {
                document.getElementById('filterStatus').value = 'expired';
                loadRenewMembers();
            });
        }
        
        // ุฒุฑ ุนุฑุถ ุนูู ูุดู ุงูุงูุชูุงุก
        const viewExpiringBtn = document.getElementById('viewExpiringBtn');
        if (viewExpiringBtn) {
            viewExpiringBtn.addEventListener('click', () => {
                document.getElementById('filterStatus').value = 'expiring-soon';
                loadRenewMembers();
            });
        }
        
        // ุฒุฑ ุนุฑุถ ุงูููููููู
        const viewSuspendedBtn = document.getElementById('viewSuspendedBtn');
        if (viewSuspendedBtn) {
            viewSuspendedBtn.addEventListener('click', () => {
                document.getElementById('filterStatus').value = 'suspended';
                loadRenewMembers();
            });
        }
        
        // ุฒุฑ ุนุฑุถ ุงููุฌุฏุฏูู
        const viewRenewedBtn = document.getElementById('viewRenewedBtn');
        if (viewRenewedBtn) {
            viewRenewedBtn.addEventListener('click', () => {
                showRenewedMembers();
            });
        }
        
        // ุงูููุงุชุฑ
        const filterElements = ['filterStatus', 'filterPackage', 'filterDuration', 'filterSort'];
        filterElements.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('change', () => {
                    renewCurrentPage = 1;
                    loadRenewMembers();
                });
            }
        });
        
        // ุนุฏุฏ ุงูุตููู ูู ุงูุตูุญุฉ
        const rowsPerPageSelect = document.getElementById('rowsPerPage');
        if (rowsPerPageSelect) {
            rowsPerPageSelect.addEventListener('change', function() {
                renewRowsPerPage = parseInt(this.value);
                renewCurrentPage = 1;
                loadRenewMembers();
            });
        }
        
        // ุฒุฑ ุชุญุฏูุฏ ุงููู
        const selectAllBtn = document.getElementById('selectAllBtn');
        if (selectAllBtn) {
            selectAllBtn.addEventListener('click', () => {
                document.querySelectorAll('.renew-checkbox').forEach(checkbox => {
                    checkbox.checked = true;
                    const memberId = checkbox.getAttribute('data-id');
                    selectedRenewMembers.add(memberId);
                });
                updateSelectAllCheckbox();
                updateRenewSelectedButton();
            });
        }
        
        // ุฒุฑ ุฅูุบุงุก ุชุญุฏูุฏ ุงููู
        const deselectAllBtn = document.getElementById('deselectAllBtn');
        if (deselectAllBtn) {
            deselectAllBtn.addEventListener('click', () => {
                document.querySelectorAll('.renew-checkbox').forEach(checkbox => {
                    checkbox.checked = false;
                    const memberId = checkbox.getAttribute('data-id');
                    selectedRenewMembers.delete(memberId);
                });
                updateSelectAllCheckbox();
                updateRenewSelectedButton();
            });
        }
        
        // ุฒุฑ ุชุฌุฏูุฏ ุงููุญุฏุฏูู
        const renewSelectedBtn = document.getElementById('renewSelectedBtn');
        if (renewSelectedBtn) {
            renewSelectedBtn.addEventListener('click', () => {
                if (selectedRenewMembers.size === 0) return;
                
                if (selectedRenewMembers.size === 1) {
                    const memberId = Array.from(selectedRenewMembers)[0];
                    const member = subscriptions.find(m => m.id === memberId);
                    if (member) openRenewModal(member);
                } else {
                    openBulkRenewModal();
                }
            });
        }
        
        // ุฒุฑ ุฅุฑุณุงู ุชุฐููุฑุงุช
        const sendRemindersBtn = document.getElementById('sendRemindersBtn');
        if (sendRemindersBtn) {
            sendRemindersBtn.addEventListener('click', () => {
                openRemindersModal();
            });
        }
        
        // ุฒุฑ ุชุตุฏูุฑ ุงููุงุฆูุฉ
        const exportListBtn = document.getElementById('exportListBtn');
        if (exportListBtn) {
            exportListBtn.addEventListener('click', exportRenewList);
        }
        
        // ุฒุฑ ุทุจุงุนุฉ ุงููุงุฆูุฉ
        const printListBtn = document.getElementById('printListBtn');
        if (printListBtn) {
            printListBtn.addEventListener('click', printRenewList);
        }
        
        // ุฒุฑ ุนุฑุถ ุฌููุน ุงูุชุฌุฏูุฏุงุช
        const viewAllRenewalsBtn = document.getElementById('viewAllRenewalsBtn');
        if (viewAllRenewalsBtn) {
            viewAllRenewalsBtn.addEventListener('click', showAllRenewals);
        }
        
        // ูููุฐุฌ ุงูุชุฌุฏูุฏ ุงููุฑุฏู
        const renewForm = document.getElementById('renewForm');
        if (renewForm) {
            renewForm.addEventListener('submit', handleRenewSubmit);
            
            // ุญุณุงุจ ุงูุชูุงุฑูุฎ ุชููุงุฆูุงู
            const renewDuration = document.getElementById('renewDuration');
            const renewStartDate = document.getElementById('renewStartDate');
            const renewEndDate = document.getElementById('renewEndDate');
            
            if (renewDuration && renewStartDate && renewEndDate) {
                renewDuration.addEventListener('change', updateEndDate);
                renewStartDate.addEventListener('change', updateEndDate);
            }
            
            // ุญุณุงุจ ุงูุณุนุฑ ุงูููุงุฆู
            const renewPrice = document.getElementById('renewPrice');
            const renewDiscount = document.getElementById('renewDiscount');
            const renewFinalPrice = document.getElementById('renewFinalPrice');
            
            if (renewPrice && renewDiscount && renewFinalPrice) {
                renewPrice.addEventListener('input', updateFinalPrice);
                renewDiscount.addEventListener('input', updateFinalPrice);
            }
        }
        
        // ูููุฐุฌ ุงูุชุฌุฏูุฏ ุงูุฌูุงุนู
        const bulkRenewForm = document.getElementById('bulkRenewForm');
        if (bulkRenewForm) {
            bulkRenewForm.addEventListener('submit', handleBulkRenewSubmit);
            
            // ุญุณุงุจ ุงูุฅุฌูุงูู
            const bulkPrice = document.getElementById('bulkRenewPrice');
            if (bulkPrice) {
                bulkPrice.addEventListener('input', updateBulkSummary);
            }
        }
        
        // ูููุฐุฌ ุงูุชุฐููุฑุงุช
        const remindersForm = document.getElementById('remindersForm');
        if (remindersForm) {
            remindersForm.addEventListener('submit', handleRemindersSubmit);
        }
        
        // ุงูุชุฑุญูู
        const prevBtn = document.getElementById('prevPageBtn');
        const nextBtn = document.getElementById('nextPageBtn');
        
        if (prevBtn) {
            prevBtn.addEventListener('click', () => {
                if (renewCurrentPage > 1) {
                    renewCurrentPage--;
                    loadRenewMembers();
                }
            });
        }
        
        if (nextBtn) {
            nextBtn.addEventListener('click', () => {
                const totalPages = Math.ceil(renewFilteredMembers.length / renewRowsPerPage);
                if (renewCurrentPage < totalPages) {
                    renewCurrentPage++;
                    loadRenewMembers();
                }
            });
        }
    }
    
    // ุฏุงูุฉ ุชุนุจุฆุฉ ุฎูุงุฑุงุช ุงูุจุงูุงุช
    function fillPackageOptions() {
        const selects = ['renewPackage', 'bulkRenewPackage', 'filterPackage'];
        
        selects.forEach(selectId => {
            const select = document.getElementById(selectId);
            if (!select) return;
            
            // ูุณุญ ุงูุฎูุงุฑุงุช ุงูุญุงููุฉ
            while (select.options.length > 1) {
                select.remove(1);
            }
            
            // ุฅุถุงูุฉ ุงูุจุงูุงุช
            packages.forEach(pkg => {
                const option = document.createElement('option');
                option.value = pkg.name;
                option.textContent = `${pkg.name} - ${pkg.price} ุฌ.ู`;
                select.appendChild(option);
            });
        });
    }
    
    // ุฏุงูุฉ ูุชุญ ูููุฐุฌ ุงูุชุฌุฏูุฏ
    function openRenewModal(member) {
        if (!member) return;
        
        // ุชุนุจุฆุฉ ุจูุงูุงุช ุงูุนุถู
        document.getElementById('renewMemberName').textContent = member.name;
        document.getElementById('renewMemberCode').textContent = member.id;
        document.getElementById('renewMemberPhone').textContent = member.phone;
        document.getElementById('renewOldPackage').textContent = member.package;
        document.getElementById('renewOldEndDate').textContent = formatDate(member.endDate);
        
        // ุชุญุฏูุฏ ุญุงูุฉ ุงูุนุถู
        const endDate = new Date(member.endDate);
        const today = new Date();
        const daysRemaining = Math.ceil((endDate - today) / (1000 * 60 * 60 * 24));
        
        let statusText = '';
        if (member.status === 'suspended') {
            statusText = 'ููููู';
        } else if (daysRemaining <= 0) {
            statusText = 'ููุชูู';
        } else if (daysRemaining <= 7) {
            statusText = `ููุชูู ุฎูุงู ${daysRemaining} ุฃูุงู`;
        } else {
            statusText = 'ูุดุท';
        }
        
        document.getElementById('renewMemberStatus').textContent = statusText;
        
        // ุชุนุจุฆุฉ ุฎูุงุฑุงุช ุงูุจุงูุฉ
        const packageSelect = document.getElementById('renewPackage');
        if (packageSelect) {
            packageSelect.value = member.package;
        }
        
        // ุชุนููู ุชุงุฑูุฎ ุงูููู
        const todayStr = new Date().toISOString().split('T')[0];
        document.getElementById('renewStartDate').value = todayStr;
        
        // ุชุนููู ุงูุณุนุฑ
        document.getElementById('renewPrice').value = member.price;
        
        // ุชุญุฏูุซ ุงูุชูุงุฑูุฎ ูุงูุณุนุฑ
        updateEndDate();
        updateFinalPrice();
        
        // ูุชุญ ุงููููุฐุฌ
        openModal('renewModal');
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุชุงุฑูุฎ ุงูุงูุชูุงุก
    function updateEndDate() {
        const duration = parseInt(document.getElementById('renewDuration').value);
        const startDate = document.getElementById('renewStartDate').value;
        
        if (duration && startDate) {
            const endDate = new Date(startDate);
            endDate.setMonth(endDate.getMonth() + duration);
            
            document.getElementById('renewEndDate').value = endDate.toISOString().split('T')[0];
        }
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุงูุณุนุฑ ุงูููุงุฆู
    function updateFinalPrice() {
        const price = parseFloat(document.getElementById('renewPrice').value) || 0;
        const discount = parseFloat(document.getElementById('renewDiscount').value) || 0;
        const finalPrice = price - discount;
        
        document.getElementById('renewFinalPrice').value = finalPrice;
        document.getElementById('summaryPackagePrice').textContent = `${price} ุฌ.ู`;
        document.getElementById('summaryDiscount').textContent = `${discount} ุฌ.ู`;
        document.getElementById('summaryTotal').textContent = `${finalPrice} ุฌ.ู`;
    }
    
    // ุฏุงูุฉ ูุนุงูุฌุฉ ุงูุชุฌุฏูุฏ
    async function handleRenewSubmit(e) {
        e.preventDefault();
        
        const memberCode = document.getElementById('renewMemberCode').textContent;
        const member = subscriptions.find(m => m.id === memberCode);
        if (!member) return;
        
        const renewData = {
            package: document.getElementById('renewPackage').value,
            duration: parseInt(document.getElementById('renewDuration').value),
            startDate: document.getElementById('renewStartDate').value,
            endDate: document.getElementById('renewEndDate').value,
            price: parseFloat(document.getElementById('renewPrice').value),
            discount: parseFloat(document.getElementById('renewDiscount').value) || 0,
            finalPrice: parseFloat(document.getElementById('renewFinalPrice').value),
            paymentMethod: document.getElementById('renewPaymentMethod').value,
            notes: document.getElementById('renewNotes').value
        };
        
        // ุชุญุฏูุซ ุจูุงูุงุช ุงูุนุถู
        member.package = renewData.package;
        member.startDate = renewData.startDate;
        member.endDate = renewData.endDate;
        member.price = renewData.finalPrice;
        member.paymentMethod = renewData.paymentMethod;
        member.status = 'active';
        
        // ุฅุถุงูุฉ ูุดุงุท ุงูุชุฌุฏูุฏ
        const newActivity = {
            id: activities.length + 1,
            type: 'ุชุฌุฏูุฏ ุงุดุชุฑุงู',
            user: member.name,
            amount: renewData.finalPrice,
            date: new Date().toISOString().split('T')[0],
            time: new Date().toLocaleTimeString('ar-EG', { 
                hour: '2-digit', 
                minute: '2-digit' 
            }),
            details: `ุชู ุชุฌุฏูุฏ ุงูุงุดุชุฑุงู - ${renewData.package}`
        };
        
        activities.unshift(newActivity);
        
        // ุญูุธ ุงูุจูุงูุงุช
        saveData();
        
        // ุฅุบูุงู ุงููููุฐุฌ
        closeModal('renewModal');
        
        // ุชุญุฏูุซ ุงูุนุฑุถ
        loadRenewMembers();
        updateRenewStats();
        updateRecentRenewals();
        
        // ุนุฑุถ ุฑุณุงูุฉ ุงููุฌุงุญ
        showAlert('ุชู ุงูุชุฌุฏูุฏ', `ุชู ุชุฌุฏูุฏ ุงุดุชุฑุงู ${member.name} ุจูุฌุงุญ`, true);
    }
    
    // ุฏุงูุฉ ูุชุญ ูููุฐุฌ ุงูุชุฌุฏูุฏ ุงูุฌูุงุนู
    function openBulkRenewModal() {
        const selectedMembers = Array.from(selectedRenewMembers)
            .map(id => subscriptions.find(m => m.id === id))
            .filter(m => m);
        
        if (selectedMembers.length === 0) return;
        
        // ุชุญุฏูุซ ุงูุนุฏุงุฏ
        document.getElementById('bulkMembersCount').textContent = selectedMembers.length;
        document.getElementById('bulkSummaryCount').textContent = selectedMembers.length;
        
        // ุนุฑุถ ูุงุฆูุฉ ุงูุฃุนุถุงุก ุงููุญุฏุฏูู
        const membersList = document.getElementById('bulkMembersList');
        let listHtml = '';
        
        selectedMembers.forEach(member => {
            listHtml += `
                <div class="member-item">
                    <span>${member.name}</span>
                    <span class="member-status ${member.status}">
                        ${member.status === 'active' ? 'ูุดุท' : 'ููููู'}
                    </span>
                </div>
            `;
        });
        
        membersList.innerHTML = listHtml;
        
        // ุชุนููู ุชุงุฑูุฎ ุงูููู
        const todayStr = new Date().toISOString().split('T')[0];
        document.getElementById('bulkRenewStartDate').value = todayStr;
        
        // ูุชุญ ุงููููุฐุฌ
        openModal('bulkRenewModal');
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ููุฎุต ุงูุชุฌุฏูุฏ ุงูุฌูุงุนู
    function updateBulkSummary() {
        const price = parseFloat(document.getElementById('bulkRenewPrice').value) || 0;
        const count = parseInt(document.getElementById('bulkSummaryCount').textContent) || 0;
        const total = price * count;
        
        document.getElementById('bulkSummaryPrice').textContent = `${price} ุฌ.ู`;
        document.getElementById('bulkSummaryTotal').textContent = `${total} ุฌ.ู`;
    }
    
    // ุฏุงูุฉ ูุนุงูุฌุฉ ุงูุชุฌุฏูุฏ ุงูุฌูุงุนู
    async function handleBulkRenewSubmit(e) {
        e.preventDefault();
        
        const bulkData = {
            package: document.getElementById('bulkRenewPackage').value,
            duration: parseInt(document.getElementById('bulkRenewDuration').value),
            price: parseFloat(document.getElementById('bulkRenewPrice').value),
            paymentMethod: document.getElementById('bulkRenewPaymentMethod').value,
            startDate: document.getElementById('bulkRenewStartDate').value
        };
        
        const selectedMembers = Array.from(selectedRenewMembers)
            .map(id => subscriptions.find(m => m.id === id))
            .filter(m => m);
        
        // ุญุณุงุจ ุชุงุฑูุฎ ุงูุงูุชูุงุก
        const endDate = new Date(bulkData.startDate);
        endDate.setMonth(endDate.getMonth() + bulkData.duration);
        const endDateStr = endDate.toISOString().split('T')[0];
        
        // ุชุญุฏูุซ ุฌููุน ุงูุฃุนุถุงุก ุงููุญุฏุฏูู
        selectedMembers.forEach(member => {
            member.package = bulkData.package;
            member.startDate = bulkData.startDate;
            member.endDate = endDateStr;
            member.price = bulkData.price;
            member.paymentMethod = bulkData.paymentMethod;
            member.status = 'active';
            
            // ุฅุถุงูุฉ ูุดุงุท ุงูุชุฌุฏูุฏ
            const newActivity = {
                id: activities.length + 1,
                type: 'ุชุฌุฏูุฏ ุงุดุชุฑุงู',
                user: member.name,
                amount: bulkData.price,
                date: new Date().toISOString().split('T')[0],
                time: new Date().toLocaleTimeString('ar-EG', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                }),
                details: `ุชู ุชุฌุฏูุฏ ุงูุงุดุชุฑุงู - ${bulkData.package}`
            };
            
            activities.unshift(newActivity);
        });
        
        // ุญูุธ ุงูุจูุงูุงุช
        saveData();
        
        // ุฅุบูุงู ุงููููุฐุฌ
        closeModal('bulkRenewModal');
        
        // ุชุญุฏูุซ ุงูุนุฑุถ
        loadRenewMembers();
        updateRenewStats();
        updateRecentRenewals();
        
        // ุนุฑุถ ุฑุณุงูุฉ ุงููุฌุงุญ
        showAlert('ุชู ุงูุชุฌุฏูุฏ', `ุชู ุชุฌุฏูุฏ ${selectedMembers.length} ุงุดุชุฑุงู ุจูุฌุงุญ`, true);
    }
    
    // ุฏุงูุฉ ูุชุญ ูููุฐุฌ ุงูุชุฐููุฑุงุช
    function openRemindersModal() {
        // ุชุญุฏูุซ ุนุฏุฏ ุงููุณุชูููู
        const recipientsCount = renewFilteredMembers.length;
        document.getElementById('recipientsCount').textContent = recipientsCount;
        
        // ุนุฑุถ ุนููุฉ ูู ุงููุณุชูููู
        const preview = document.getElementById('recipientsPreview');
        let previewHtml = '';
        
        const sampleMembers = renewFilteredMembers.slice(0, 5);
        sampleMembers.forEach(member => {
            previewHtml += `
                <div class="recipient-item">
                    <span>${member.name}</span>
                    <span>${member.phone}</span>
                </div>
            `;
        });
        
        if (recipientsCount > 5) {
            previewHtml += `
                <div class="recipient-item more">
                    ... ู ${recipientsCount - 5} ุนุถู ุขุฎุฑ
                </div>
            `;
        }
        
        preview.innerHTML = previewHtml || '<div class="no-recipients">ูุง ููุฌุฏ ูุณุชูููู</div>';
        
        // ูุชุญ ุงููููุฐุฌ
        openModal('remindersModal');
    }
    
    // ุฏุงูุฉ ูุนุงูุฌุฉ ุฅุฑุณุงู ุงูุชุฐููุฑุงุช
    async function handleRemindersSubmit(e) {
        e.preventDefault();
        
        const reminderType = document.getElementById('reminderType').value;
        const message = document.getElementById('reminderMessage').value;
        const whatsappEnabled = document.getElementById('reminderWhatsApp').checked;
        const smsEnabled = document.getElementById('reminderSMS').checked;
        
        // ุชุตููุฉ ุงูุฃุนุถุงุก ุญุณุจ ุงูููุน
        let membersToNotify = [];
        
        switch(reminderType) {
            case 'expired':
                membersToNotify = renewFilteredMembers.filter(member => {
                    const endDate = new Date(member.endDate);
                    const today = new Date();
                    return endDate < today;
                });
                break;
                
            case 'expiring-soon':
                const weekFromNow = new Date();
                weekFromNow.setDate(weekFromNow.getDate() + 7);
                
                membersToNotify = renewFilteredMembers.filter(member => {
                    const endDate = new Date(member.endDate);
                    const today = new Date();
                    return endDate >= today && endDate <= weekFromNow;
                });
                break;
                
            default:
                membersToNotify = renewFilteredMembers;
        }
        
        // ูุญุงูุงุฉ ุฅุฑุณุงู ุงูุชุฐููุฑุงุช
        let sentCount = 0;
        
        membersToNotify.forEach(member => {
            // ุงุณุชุจุฏุงู ุงููุชุบูุฑุงุช ูู ุงูุฑุณุงูุฉ
            const personalizedMessage = message
                .replace(/{ุงุณู_ุงูุนุถู}/g, member.name)
                .replace(/{ุญุงูุฉ_ุงูุงุดุชุฑุงู}/g, getMemberStatusText(member))
                .replace(/{ุชุงุฑูุฎ_ุงูุงูุชูุงุก}/g, formatDate(member.endDate));
            
            // ูุญุงูุงุฉ ุงูุฅุฑุณุงู
            if (whatsappEnabled) {
                // ูุญุงูุงุฉ ุฅุฑุณุงู ูุงุชุณุงุจ
                console.log(`ุฅุฑุณุงู ูุงุชุณุงุจ ุฅูู ${member.phone}: ${personalizedMessage}`);
            }
            
            if (smsEnabled) {
                // ูุญุงูุงุฉ ุฅุฑุณุงู SMS
                console.log(`ุฅุฑุณุงู SMS ุฅูู ${member.phone}: ${personalizedMessage}`);
            }
            
            sentCount++;
        });
        
        // ุฅุบูุงู ุงููููุฐุฌ
        closeModal('remindersModal');
        
        // ุนุฑุถ ุฑุณุงูุฉ ุงููุฌุงุญ
        showAlert('ุชู ุงูุฅุฑุณุงู', `ุชู ุฅุฑุณุงู ${sentCount} ุชุฐููุฑ ุจูุฌุงุญ`, true);
    }
    
    // ุฏุงูุฉ ุงูุญุตูู ุนูู ูุต ุญุงูุฉ ุงูุนุถู
    function getMemberStatusText(member) {
        const endDate = new Date(member.endDate);
        const today = new Date();
        const daysRemaining = Math.ceil((endDate - today) / (1000 * 60 * 60 * 24));
        
        if (member.status === 'suspended') {
            return 'ููููู';
        } else if (daysRemaining <= 0) {
            return 'ููุชูู';
        } else if (daysRemaining <= 7) {
            return `ุณููุชูู ุฎูุงู ${daysRemaining} ุฃูุงู`;
        } else {
            return 'ูุดุท';
        }
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุฒุฑ ุงูุชุฌุฏูุฏ ุงููุญุฏุฏูู
    function updateRenewSelectedButton() {
        const selectedCount = selectedRenewMembers.size;
        const btn = document.getElementById('renewSelectedBtn');
        const countSpan = btn.querySelector('.selected-count');
        
        if (countSpan) {
            countSpan.textContent = `(${selectedCount})`;
        }
        
        btn.disabled = selectedCount === 0;
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุชุญุฏูุฏ ุงููู
    function updateSelectAllCheckbox() {
        const checkboxes = document.querySelectorAll('.renew-checkbox');
        const allChecked = checkboxes.length > 0 && 
            Array.from(checkboxes).every(cb => cb.checked);
        
        document.getElementById('selectAllCheckbox').checked = allChecked;
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุงูุชุฑุญูู
    function updateRenewPagination() {
        const totalPages = Math.ceil(renewFilteredMembers.length / renewRowsPerPage);
        
        document.querySelector('.current-page').textContent = renewCurrentPage;
        document.querySelector('.total-pages').textContent = totalPages;
        
        const prevBtn = document.getElementById('prevPageBtn');
        const nextBtn = document.getElementById('nextPageBtn');
        
        if (prevBtn) prevBtn.disabled = renewCurrentPage === 1;
        if (nextBtn) nextBtn.disabled = renewCurrentPage === totalPages || totalPages === 0;
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ูุงุฆูุฉ ุงูุชุฌุฏูุฏุงุช ุงูุฃุฎูุฑุฉ
    function updateRecentRenewals() {
        const renewalsList = document.getElementById('renewalsList');
        if (!renewalsList) return;
        
        // ุงูุญุตูู ุนูู ุขุฎุฑ 5 ุชุฌุฏูุฏุงุช
        const recentRenewals = activities
            .filter(activity => activity.type === 'ุชุฌุฏูุฏ ุงุดุชุฑุงู')
            .slice(0, 5);
        
        if (recentRenewals.length === 0) {
            renewalsList.innerHTML = `
                <div class="no-renewals">
                    <i class="fas fa-redo"></i>
                    <p>ูุง ุชูุฌุฏ ุชุฌุฏูุฏุงุช ุญุฏูุซุฉ</p>
                </div>
            `;
            return;
        }
        
        let listHtml = '';
        
        recentRenewals.forEach(activity => {
            listHtml += `
                <div class="renewal-item">
                    <div class="renewal-icon">
                        <i class="fas fa-redo"></i>
                    </div>
                    <div class="renewal-info">
                        <h5>${activity.user}</h5>
                        <p>${activity.details}</p>
                        <small>${activity.date} - ${activity.time}</small>
                    </div>
                    <div class="renewal-amount">
                        ${activity.amount} ุฌ.ู
                    </div>
                </div>
            `;
        });
        
        renewalsList.innerHTML = listHtml;
    }
    
    // ุฏุงูุฉ ุนุฑุถ ุงูุฃุนุถุงุก ุงููุฌุฏุฏูู
    function showRenewedMembers() {
        const currentMonth = new Date().getMonth() + 1;
        const renewedMembers = activities
            .filter(activity => {
                if (activity.type !== 'ุชุฌุฏูุฏ ุงุดุชุฑุงู') return false;
                const activityDate = new Date(activity.date);
                return activityDate.getMonth() + 1 === currentMonth;
            })
            .map(activity => {
                return subscriptions.find(member => member.name === activity.user);
            })
            .filter(member => member);
        
        // ูููู ูุชุญ ูุงุฆูุฉ ูููุตูุฉ ุฃู ุชุญุฏูุซ ุงูููุชุฑุฉ
        showAlert('ุงูุฃุนุถุงุก ุงููุฌุฏุฏูู', 
            `ุชู ุชุฌุฏูุฏ ${renewedMembers.length} ุงุดุชุฑุงู ูุฐุง ุงูุดูุฑ`, 
            true
        );
    }
    
    // ุฏุงูุฉ ุนุฑุถ ุฌููุน ุงูุชุฌุฏูุฏุงุช
    function showAllRenewals() {
        // ูู ุงูุฅุตุฏุงุฑ ุงูุญุงููุ ูุนุฑุถ ุฑุณุงูุฉ
        // ูููู ุฅูุดุงุก ุตูุญุฉ ูููุตูุฉ ูู ุงููุณุชูุจู
        showAlert('ุฌููุน ุงูุชุฌุฏูุฏุงุช', 
            'ุณูุชู ุนุฑุถ ูุงุฆูุฉ ุจุฌููุน ุนูููุงุช ุงูุชุฌุฏูุฏ ุงูุณุงุจูุฉ ูู ุฅุตุฏุงุฑ ูุงุญู', 
            false
        );
    }
    
    // ุฏุงูุฉ ุชุตุฏูุฑ ูุงุฆูุฉ ุงูุชุฌุฏูุฏ
    function exportRenewList() {
        const exportData = renewFilteredMembers.map(member => ({
            'ููุฏ ุงูุนุถู': member.id,
            'ุงูุงุณู': member.name,
            'ุงููุงุชู': member.phone,
            'ุงูุจุงูุฉ': member.package,
            'ุงูุณุนุฑ': member.price,
            'ุชุงุฑูุฎ ุงูุจุฏุก': member.startDate,
            'ุชุงุฑูุฎ ุงูุงูุชูุงุก': member.endDate,
            'ุงูุญุงูุฉ': getMemberStatusText(member)
        }));
        
        const dataStr = JSON.stringify(exportData, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
        
        const exportFileName = `ูุงุฆูุฉ_ุงูุชุฌุฏูุฏ_${new Date().toISOString().split('T')[0]}.json`;
        
        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileName);
        document.body.appendChild(linkElement);
        linkElement.click();
        document.body.removeChild(linkElement);
        
        showAlert('ุชู ุงูุชุตุฏูุฑ', 'ุชู ุชุตุฏูุฑ ูุงุฆูุฉ ุงูุชุฌุฏูุฏ ุจูุฌุงุญ', true);
    }
    
    // ุฏุงูุฉ ุทุจุงุนุฉ ูุงุฆูุฉ ุงูุชุฌุฏูุฏ
    function printRenewList() {
        // ุฅูุดุงุก ูุงูุฐุฉ ุทุจุงุนุฉ
        const printWindow = window.open('', '_blank');
        
        // ุฅูุดุงุก ูุญุชูู HTML ููุทุจุงุนุฉ
        let printContent = `
            <!DOCTYPE html>
            <html dir="rtl">
            <head>
                <title>ูุงุฆูุฉ ุงูุชุฌุฏูุฏ</title>
                <style>
                    body { font-family: 'Cairo', sans-serif; direction: rtl; padding: 20px; }
                    h1 { text-align: center; color: #0f4c75; margin-bottom: 30px; }
                    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                    th, td { padding: 10px; border: 1px solid #ddd; text-align: right; }
                    th { background-color: #f5f7fa; font-weight: bold; }
                    .header-info { margin-bottom: 20px; text-align: center; }
                    .print-date { margin-top: 30px; text-align: left; }
                    @media print {
                        .no-print { display: none; }
                    }
                </style>
            </head>
            <body>
                <h1>ูุงุฆูุฉ ุงูุฃุนุถุงุก ููุชุฌุฏูุฏ</h1>
                <div class="header-info">
                    <p>ุชุงุฑูุฎ ุงูุทุจุงุนุฉ: ${new Date().toLocaleDateString('ar-EG')}</p>
                    <p>ุฅุฌูุงูู ุงูุฃุนุถุงุก: ${renewFilteredMembers.length}</p>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ููุฏ ุงูุนุถู</th>
                            <th>ุงูุงุณู</th>
                            <th>ุงููุงุชู</th>
                            <th>ุงูุจุงูุฉ</th>
                            <th>ุชุงุฑูุฎ ุงูุงูุชูุงุก</th>
                            <th>ุงูุญุงูุฉ</th>
                        </tr>
                    </thead>
                    <tbody>
        `;
        
        renewFilteredMembers.forEach(member => {
            printContent += `
                <tr>
                    <td>${member.id}</td>
                    <td>${member.name}</td>
                    <td>${member.phone}</td>
                    <td>${member.package}</td>
                    <td>${formatDate(member.endDate)}</td>
                    <td>${getMemberStatusText(member)}</td>
                </tr>
            `;
        });
        
        printContent += `
                    </tbody>
                </table>
                <div class="print-date">
                    <p>ุชูุช ุงูุทุจุงุนุฉ ุจูุงุณุทุฉ ูุธุงู ุฅุฏุงุฑุฉ ุงูุฌูู</p>
                </div>
                <button class="no-print" onclick="window.print()" style="
                    position: fixed; top: 20px; right: 20px; 
                    padding: 10px 20px; background: #0f4c75; 
                    color: white; border: none; border-radius: 5px; 
                    cursor: pointer;">
                    ุทุจุงุนุฉ
                </button>
            </body>
            </html>`;
        
        printWindow.document.write(printContent);
        printWindow.document.close();
    };
    
    // ุชุดุบูู ุชููุฆุฉ ุงูุตูุญุฉ ุนูุฏ ุงูุชุญููู
    document.addEventListener('DOMContentLoaded', () => {
        initRenewPage();
        updateRecentRenewals();
    });
    </script>
</body>
</html>