<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุฅุดุนุงุฑุงุช - ูุธุงู ุฅุฏุงุฑุฉ ุงูุฌูู</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <!-- ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-dumbbell"></i>
                    </div>
                    <h1>GYM <span>MANAGER</span></h1>
                </div>
                <button class="sidebar-close" id="sidebarClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="sidebar-profile">
                <div class="profile-img">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=0f4c75&color=fff" alt="ุตูุฑุฉ ุงููุณุชุฎุฏู">
                </div>
                <div class="profile-info">
                    <h3 id="userName">ุงููุณุคูู ุงูุฑุฆูุณู</h3>
                    <p id="userRole">ูุณุคูู</p>
                    <span class="status online" id="userStatus">ูุชุตู</span>
                </div>
            </div>
            
            <nav class="sidebar-menu">
                <ul>
                    <li>
                        <a href="dashboard.html">
                            <i class="fas fa-home"></i>
                            <span>ููุญุฉ ุงูุชุญูู</span>
                        </a>
                    </li>
                    <li>
                        <a href="members.html">
                            <i class="fas fa-users"></i>
                            <span>ุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก</span>
                        </a>
                    </li>
                    <li>
                        <a href="renew.html">
                            <i class="fas fa-redo"></i>
                            <span>ุชุฌุฏูุฏ ุงูุงุดุชุฑุงูุงุช</span>
                        </a>
                    </li>
                    <li>
                        <a href="calendar.html">
                            <i class="fas fa-calendar-alt"></i>
                            <span>ุงูุชูููู ูุงูุงุดุชุฑุงูุงุช</span>
                        </a>
                    </li>
                    <li>
                        <a href="subscriptions.html">
                            <i class="fas fa-credit-card"></i>
                            <span>ุงูุงุดุชุฑุงูุงุช</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="notifications.html">
                            <i class="fas fa-bell"></i>
                            <span>ุงูุฅุดุนุงุฑุงุช</span>
                            <span class="notification-badge" id="sidebarNotificationCount">3</span>
                        </a>
                    </li>
                    <li>
                        <a href="settings.html">
                            <i class="fas fa-cog"></i>
                            <span>ุงูุฅุนุฏุงุฏุงุช</span>
                        </a>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <button class="btn-logout" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>ุชุณุฌูู ุงูุฎุฑูุฌ</span>
                </button>
            </div>
        </aside>
        
        <!-- ุทุจูุฉ ุงูุชุนุชูู ูููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>
        
        <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
        <main class="main-content">
            <!-- ุดุฑูุท ุงูุฑุฃุณ ุงูุนููู -->
            <header class="top-header">
                <div class="header-left">
                    <button class="sidebar-toggle" id="sidebarToggle">
                        <i class="fas fa-bars"></i>
                    </button>
                 
                    
               
                </div>
            </header>
            
            <!-- ูุญุชูู ุตูุญุฉ ุงูุฅุดุนุงุฑุงุช -->
            <div class="dashboard-content">
                <!-- ุฅุญุตุงุฆูุงุช ุณุฑูุนุฉ -->
                
                
                
                <!-- ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช -->
                <div class="notifications-list-container">
                    <div class="table-header">
                        <h3>ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช</h3>
                        <div class="table-actions">
                            <span id="notificationsCount">12 ุฅุดุนุงุฑ</span>
                            <div class="selection-buttons">
                                <button class="btn-secondary" id="selectAllNotificationsBtn">
                                    <i class="fas fa-check-square"></i> ุชุญุฏูุฏ ุงููู
                                </button>
                                <button class="btn-secondary" id="deselectAllNotificationsBtn">
                                    <i class="far fa-square"></i> ุฅูุบุงุก ุงููู
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="notifications-content" id="notificationsContent">
                        <!-- ุณุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
                    </div>
                    
                    <div class="table-footer">
                        <div class="pagination">
                            <button class="pagination-btn" id="prevNotificationsBtn" disabled>
                                <i class="fas fa-chevron-right"></i>
                            </button>
                            <span class="page-numbers">
                                <span class="current-page">1</span> ูู <span class="total-pages">2</span>
                            </span>
                            <button class="pagination-btn" id="nextNotificationsBtn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                        </div>
                        
                        <div class="rows-per-page">
                            <span>ุนุฑุถ</span>
                            <select id="notificationsPerPage">
                                <option value="10">10</option>
                                <option value="25" selected>25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                            <span>ุฅุดุนุงุฑ ูู ูู ุตูุญุฉ</span>
                        </div>
                    </div>
                </div>
                
                <!-- ุงูุฅุดุนุงุฑุงุช ุงููููุฉ -->
                <div class="important-notifications">
                    <div class="section-header">
                        <h3>
                            <i class="fas fa-star" style="color: #f39c12;"></i>
                            ุงูุฅุดุนุงุฑุงุช ุงููููุฉ
                        </h3>
                        <button class="btn-secondary" id="clearImportantBtn">
                            <i class="fas fa-times"></i> ูุณุญ ุงููู
                        </button>
                    </div>
                    <div class="important-list" id="importantList">
                        <!-- ุณุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- ูููุฐุฌ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช -->
    <div id="notificationSettingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="notificationSettingsForm">
                    <div class="notification-categories">
                        <h4>ุฃููุงุน ุงูุฅุดุนุงุฑุงุช</h4>
                        
                        <div class="category-item">
                            <div class="category-info">
                                <h5>ุงุดุชุฑุงูุงุช ุฌุฏูุฏุฉ</h5>
                                <p>ุนูุฏ ุฅุถุงูุฉ ุนุถู ุฌุฏูุฏ</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="notifyNewMembers" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="category-item">
                            <div class="category-info">
                                <h5>ุชุฌุฏูุฏ ุงุดุชุฑุงูุงุช</h5>
                                <p>ุนูุฏ ุชุฌุฏูุฏ ุงุดุชุฑุงู ุนุถู</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="notifyRenewals" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="category-item">
                            <div class="category-info">
                                <h5>ุงุดุชุฑุงูุงุช ููุชููุฉ</h5>
                                <p>ุนูุฏ ุงูุชูุงุก ุงุดุชุฑุงู ุนุถู</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="notifyExpired" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="category-item">
                            <div class="category-info">
                                <h5>ุงุดุชุฑุงูุงุช ุนูู ูุดู ุงูุงูุชูุงุก</h5>
                                <p>ูุจู ุงูุชูุงุก ุงูุงุดุชุฑุงู ุจ 7 ุฃูุงู</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="notifyExpiring" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="category-item">
                            <div class="category-info">
                                <h5>ูุฏููุนุงุช</h5>
                                <p>ุนูุฏ ุงุณุชูุงู ุฏูุนุฉ</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="notifyPayments" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="notification-methods">
                        <h4>ุทุฑู ุงูุฅุฑุณุงู</h4>
                        
                        <div class="method-item">
                            <div class="method-info">
                                <h5>ุงูุฅุดุนุงุฑุงุช ุฏุงุฎู ุงููุธุงู</h5>
                                <p>ุนุฑุถ ุงูุฅุดุนุงุฑุงุช ูู ูุฐู ุงูุตูุญุฉ</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="methodInApp" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="method-item">
                            <div class="method-info">
                                <h5>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</h5>
                                <p>ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุนุจุฑ ุงูุจุฑูุฏ</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="methodEmail">
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="method-item">
                            <div class="method-info">
                                <h5>ุฑุณุงุฆู SMS</h5>
                                <p>ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุนุจุฑ ุฑุณุงุฆู ูุตูุฉ</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="methodSMS">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="notificationSound">ุตูุช ุงูุฅุดุนุงุฑุงุช</label>
                        <select id="notificationSound">
                            <option value="default">ุงูุตูุช ุงูุงูุชุฑุงุถู</option>
                            <option value="soft">ุตูุช ูุงุนู</option>
                            <option value="alert">ุตูุช ุชูุจูู</option>
                            <option value="none">ุจุฏูู ุตูุช</option>
                        </select>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-primary">ุญูุธ ุงูุฅุนุฏุงุฏุงุช</button>
                        <button type="button" class="btn-secondary close-modal">ุฅูุบุงุก</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- ูููุฐุฌ ุนุฑุถ ุชูุงุตูู ุงูุฅุดุนุงุฑ -->
    <div id="notificationDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="notificationDetailsTitle">ุชูุงุตูู ุงูุฅุดุนุงุฑ</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="notification-details" id="notificationDetailsContent">
                    <!-- ุณุชู ููุคูุง ุจูุงุณุทุฉ JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <script src="data.js"></script>
    <script src="script.js"></script>
    <script>
    /**
     * ุณูุฑูุจุช ุฎุงุต ุจุตูุญุฉ ุงูุฅุดุนุงุฑุงุช
     */
    
    // ูุชุบูุฑุงุช ุงูุตูุญุฉ
    let notificationsCurrentPage = 1;
    let notificationsPerPage = 25;
    let filteredNotifications = [];
    let selectedNotifications = new Set();
    
    // ุชููุฆุฉ ุตูุญุฉ ุงูุฅุดุนุงุฑุงุช
    function initNotificationsPage() {
        console.log("๐ ุชููุฆุฉ ุตูุญุฉ ุงูุฅุดุนุงุฑุงุช...");
        
        // ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
        updateNotificationsStats();
        
        // ุชุญููู ุงูุฅุดุนุงุฑุงุช
        loadNotifications();
        
        // ุชููุฆุฉ ุงูุฃุญุฏุงุซ
        initNotificationsEvents();
        
        // ุชุญุฏูุซ ุงูุนุฏุงุฏ ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
        updateSidebarNotificationCount();
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุฅุญุตุงุฆูุงุช ุงูุฅุดุนุงุฑุงุช
    function updateNotificationsStats() {
        const today = new Date().toISOString().split('T')[0];
        
        // ุฅุฌูุงูู ุงูุฅุดุนุงุฑุงุช
        const total = notifications.length;
        
        // ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ
        const unread = notifications.filter(n => !n.read).length;
        
        // ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุกุฉ
        const read = notifications.filter(n => n.read).length;
        
        // ุฅุดุนุงุฑุงุช ุงูููู
        const todayNotifications = notifications.filter(n => n.date === today).length;
        
        // ุชุญุฏูุซ ุงูุนุฏุงุฏุงุช
        document.getElementById('totalNotifications').textContent = total;
        document.getElementById('unreadNotifications').textContent = unread;
        document.getElementById('readNotifications').textContent = read;
        document.getElementById('todayNotifications').textContent = todayNotifications;
        
        // ุชุญุฏูุซ ุงูุนุฏุงุฏ ูู ุงูุดุฑูุท ุงูุนููู
        document.getElementById('notificationCount').textContent = unread;
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุงูุนุฏุงุฏ ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
    function updateSidebarNotificationCount() {
        const unreadCount = notifications.filter(n => !n.read).length;
        const sidebarCount = document.getElementById('sidebarNotificationCount');
        if (sidebarCount) {
            sidebarCount.textContent = unreadCount;
            sidebarCount.style.display = unreadCount > 0 ? 'inline-flex' : 'none';
        }
    }
   
    // ุฏุงูุฉ ุชุทุจูู ุงูููุชุฑุฉ
    function applyNotificationsFilter(type, status, date) {
        let filtered = [...notifications];
        
        // ููุชุฑุฉ ุญุณุจ ุงูููุน
        if (type !== 'all') {
            filtered = filtered.filter(n => n.type === type);
        }
        
        // ููุชุฑุฉ ุญุณุจ ุงูุญุงูุฉ
        if (status !== 'all') {
            switch(status) {
                case 'unread':
                    filtered = filtered.filter(n => !n.read);
                    break;
                case 'read':
                    filtered = filtered.filter(n => n.read);
                    break;
                case 'important':
                    filtered = filtered.filter(n => n.important);
                    break;
            }
        }
        
        // ููุชุฑุฉ ุญุณุจ ุงูุชุงุฑูุฎ
        if (date !== 'all') {
            const today = new Date();
            
            switch(date) {
                case 'today':
                    const todayStr = today.toISOString().split('T')[0];
                    filtered = filtered.filter(n => n.date === todayStr);
                    break;
                    
                case 'week':
                    const weekAgo = new Date();
                    weekAgo.setDate(today.getDate() - 7);
                    const weekAgoStr = weekAgo.toISOString().split('T')[0];
                    filtered = filtered.filter(n => n.date >= weekAgoStr);
                    break;
                    
                case 'month':
                    const monthAgo = new Date();
                    monthAgo.setMonth(today.getMonth() - 1);
                    const monthAgoStr = monthAgo.toISOString().split('T')[0];
                    filtered = filtered.filter(n => n.date >= monthAgoStr);
                    break;
            }
        }
        
        return filtered;
    }
    
    // ุฏุงูุฉ ุชุฑุชูุจ ุงูุฅุดุนุงุฑุงุช
    function sortNotifications(notificationsList, sortType) {
        const sorted = [...notificationsList];
        
        sorted.sort((a, b) => {
            switch(sortType) {
                case 'newest':
                    return new Date(b.timestamp || b.date) - new Date(a.timestamp || a.date);
                    
                case 'oldest':
                    return new Date(a.timestamp || a.date) - new Date(b.timestamp || b.date);
                    
                case 'important':
                    if (a.important && !b.important) return -1;
                    if (!a.important && b.important) return 1;
                    return new Date(b.timestamp || b.date) - new Date(a.timestamp || a.date);
                    
                default:
                    return 0;
            }
        });
        
        return sorted;
    }
    
    // ุฏุงูุฉ ุนุฑุถ ุงูุฅุดุนุงุฑุงุช
    function renderNotifications() {
        const container = document.getElementById('notificationsContent');
        if (!container) return;
        
        // ุญุณุงุจ ุงูุจุฏุงูุฉ ูุงูููุงูุฉ ููุตูุญุฉ ุงูุญุงููุฉ
        const startIndex = (notificationsCurrentPage - 1) * notificationsPerPage;
        const endIndex = startIndex + notificationsPerPage;
        const pageNotifications = filteredNotifications.slice(startIndex, endIndex);
        
        if (pageNotifications.length === 0) {
            container.innerHTML = `
                <div class="no-notifications">
                    <div class="no-data">
                        <i class="fas fa-bell-slash"></i>
                        <p>ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช</p>
                    </div>
                </div>
            `;
            return;
        }
        
        let html = '';
        
        pageNotifications.forEach(notification => {
            const notificationDate = new Date(notification.date);
            const timeAgo = getTimeAgo(notificationDate);
            
            html += `
                <div class="notification-list-item ${notification.read ? '' : 'unread'} ${notification.important ? 'important' : ''}" 
                     data-id="${notification.id}">
                    <div class="notification-list-checkbox">
                        <input type="checkbox" class="notification-checkbox" 
                               data-id="${notification.id}" 
                               ${selectedNotifications.has(notification.id) ? 'checked' : ''}>
                    </div>
                    
                    <div class="notification-list-icon">
                        <div class="notification-icon ${notification.type}">
                            ${getNotificationIcon(notification.type)}
                        </div>
                    </div>
                    
                    <div class="notification-list-content" onclick="viewNotificationDetails(${notification.id})">
                        <div class="notification-list-header">
                            <h4>${notification.title}</h4>
                            <span class="notification-time">${timeAgo}</span>
                        </div>
                        <p class="notification-message">${notification.message}</p>
                        <div class="notification-meta">
                            <span class="notification-type ${notification.type}">${getNotificationTypeText(notification.type)}</span>
                            ${notification.important ? '<span class="important-badge"><i class="fas fa-star"></i> ููู</span>' : ''}
                        </div>
                    </div>
                    
                    <div class="notification-list-actions">
                        <button class="btn-mark-read ${notification.read ? 'read' : ''}" 
                                data-id="${notification.id}" 
                                title="${notification.read ? 'ุชู ุงููุฑุงุกุฉ' : 'ุชุญุฏูุฏ ูููุฑูุก'}">
                            <i class="fas fa-${notification.read ? 'envelope-open' : 'envelope'}"></i>
                        </button>
                        
                        <button class="btn-mark-important ${notification.important ? 'important' : ''}" 
                                data-id="${notification.id}" 
                                title="${notification.important ? 'ุฅูุบุงุก ุงูุชูููุฒ' : 'ุชูููุฒ ูููู'}">
                            <i class="fas fa-${notification.important ? 'star' : 'star'}"></i>
                        </button>
                        
                        <button class="btn-delete-notification" 
                                data-id="${notification.id}" 
                                title="ุญุฐู">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
        
        // ุฅุถุงูุฉ ุงูุฃุญุฏุงุซ
        attachNotificationEvents();
        
        // ุชุญุฏูุซ ุฒุฑ ุชุญุฏูุฏ ุงููู
        updateSelectAllCheckbox();
        
        // ุชุญุฏูุซ ูุงุฆูุฉ ุงูุฅุดุนุงุฑุงุช ุงููููุฉ
        updateImportantNotifications();
    }
    
    // ุฏุงูุฉ ุงูุญุตูู ุนูู ุฃููููุฉ ุงูุฅุดุนุงุฑ
    function getNotificationIcon(type) {
        const icons = {
            'system': '<i class="fas fa-cog"></i>',
            'members': '<i class="fas fa-user-plus"></i>',
            'subscriptions': '<i class="fas fa-credit-card"></i>',
            'renewals': '<i class="fas fa-redo"></i>',
            'payments': '<i class="fas fa-money-bill-wave"></i>',
            'reminders': '<i class="fas fa-bell"></i>'
        };
        return icons[type] || '<i class="fas fa-bell"></i>';
    }
    
    // ุฏุงูุฉ ุงูุญุตูู ุนูู ูุต ููุน ุงูุฅุดุนุงุฑ
    function getNotificationTypeText(type) {
        const types = {
            'system': 'ูุธุงู',
            'members': 'ุฃุนุถุงุก',
            'subscriptions': 'ุงุดุชุฑุงูุงุช',
            'renewals': 'ุชุฌุฏูุฏุงุช',
            'payments': 'ูุฏููุนุงุช',
            'reminders': 'ุชุฐููุฑุงุช'
        };
        return types[type] || 'ุฅุดุนุงุฑ';
    }
    
    // ุฏุงูุฉ ุญุณุงุจ ุงูููุช ุงููููุถู
    function getTimeAgo(date) {
        const now = new Date();
        const diffMs = now - date;
        const diffSec = Math.floor(diffMs / 1000);
        const diffMin = Math.floor(diffSec / 60);
        const diffHour = Math.floor(diffMin / 60);
        const diffDay = Math.floor(diffHour / 24);
        
        if (diffDay > 0) {
            return `ูุจู ${diffDay} ููู`;
        } else if (diffHour > 0) {
            return `ูุจู ${diffHour} ุณุงุนุฉ`;
        } else if (diffMin > 0) {
            return `ูุจู ${diffMin} ุฏูููุฉ`;
        } else {
            return 'ุงูุขู';
        }
    }
    
    // ุฏุงูุฉ ุฅุถุงูุฉ ุงูุฃุญุฏุงุซ ููุฅุดุนุงุฑุงุช
    function attachNotificationEvents() {
        // ุตูุงุฏูู ุงูุชุญุฏูุฏ
        document.querySelectorAll('.notification-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const notificationId = parseInt(this.getAttribute('data-id'));
                
                if (this.checked) {
                    selectedNotifications.add(notificationId);
                } else {
                    selectedNotifications.delete(notificationId);
                }
                
                updateSelectAllCheckbox();
            });
        });
        
        // ุฃุฒุฑุงุฑ ุชุญุฏูุฏ ูููุฑูุก
        document.querySelectorAll('.btn-mark-read').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const notificationId = parseInt(this.getAttribute('data-id'));
                markNotificationAsRead(notificationId);
            });
        });
        
        // ุฃุฒุฑุงุฑ ุงูุชูููุฒ ูููู
        document.querySelectorAll('.btn-mark-important').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const notificationId = parseInt(this.getAttribute('data-id'));
                toggleNotificationImportance(notificationId);
            });
        });
        
        // ุฃุฒุฑุงุฑ ุงูุญุฐู
        document.querySelectorAll('.btn-delete-notification').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const notificationId = parseInt(this.getAttribute('data-id'));
                deleteNotification(notificationId);
            });
        });
    }
    
    // ุฏุงูุฉ ุชููุฆุฉ ุฃุญุฏุงุซ ุงูุตูุญุฉ
    function initNotificationsEvents() {
        // ุงูููุงุชุฑ
        const filterElements = ['filterType', 'filterStatus', 'filterDate', 'filterSort'];
        filterElements.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('change', () => {
                    notificationsCurrentPage = 1;
                    loadNotifications();
                });
            }
        });
        
        // ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ูู ุงูุตูุญุฉ
        const notificationsPerPageSelect = document.getElementById('notificationsPerPage');
        if (notificationsPerPageSelect) {
            notificationsPerPageSelect.addEventListener('change', function() {
                notificationsPerPage = parseInt(this.value);
                notificationsCurrentPage = 1;
                loadNotifications();
            });
        }
        
        // ุฒุฑ ุชุญุฏูุฏ ุงููู
        const selectAllBtn = document.getElementById('selectAllNotificationsBtn');
        if (selectAllBtn) {
            selectAllBtn.addEventListener('click', () => {
                const currentPageNotifications = getCurrentPageNotifications();
                currentPageNotifications.forEach(notification => {
                    selectedNotifications.add(notification.id);
                });
                renderNotifications();
            });
        }
        
        // ุฒุฑ ุฅูุบุงุก ุชุญุฏูุฏ ุงููู
        const deselectAllBtn = document.getElementById('deselectAllNotificationsBtn');
        if (deselectAllBtn) {
            deselectAllBtn.addEventListener('click', () => {
                selectedNotifications.clear();
                renderNotifications();
            });
        }
        
        // ุฒุฑ ุชุญุฏูุฏ ุงููู ูููุฑูุก
        const markAllReadBtn = document.getElementById('markAllReadBtn');
        if (markAllReadBtn) {
            markAllReadBtn.addEventListener('click', markAllAsRead);
        }
        
        // ุฒุฑ ุญุฐู ุงููู
        const deleteAllBtn = document.getElementById('deleteAllBtn');
        if (deleteAllBtn) {
            deleteAllBtn.addEventListener('click', deleteAllNotifications);
        }
        
        // ุฒุฑ ุชุตุฏูุฑ
        const exportBtn = document.getElementById('exportNotificationsBtn');
        if (exportBtn) {
            exportBtn.addEventListener('click', exportNotifications);
        }
        
        // ุฒุฑ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช
        const settingsBtn = document.getElementById('notificationSettingsBtn');
        if (settingsBtn) {
            settingsBtn.addEventListener('click', () => {
                openModal('notificationSettingsModal');
            });
        }
        
        // ุฒุฑ ูุณุญ ุงูุฅุดุนุงุฑุงุช ุงููููุฉ
        const clearImportantBtn = document.getElementById('clearImportantBtn');
        if (clearImportantBtn) {
            clearImportantBtn.addEventListener('click', clearAllImportant);
        }
        
        // ูููุฐุฌ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช
        const settingsForm = document.getElementById('notificationSettingsForm');
        if (settingsForm) {
            settingsForm.addEventListener('submit', saveNotificationSettings);
            
            // ุชุญููู ุงูุฅุนุฏุงุฏุงุช
            loadNotificationSettings();
        }
        
        // ุงูุชุฑุญูู
        const prevBtn = document.getElementById('prevNotificationsBtn');
        const nextBtn = document.getElementById('nextNotificationsBtn');
        
        if (prevBtn) {
            prevBtn.addEventListener('click', () => {
                if (notificationsCurrentPage > 1) {
                    notificationsCurrentPage--;
                    loadNotifications();
                }
            });
        }
        
        if (nextBtn) {
            nextBtn.addEventListener('click', () => {
                const totalPages = Math.ceil(filteredNotifications.length / notificationsPerPage);
                if (notificationsCurrentPage < totalPages) {
                    notificationsCurrentPage++;
                    loadNotifications();
                }
            });
        }
    }
    
    // ุฏุงูุฉ ุงูุญุตูู ุนูู ุฅุดุนุงุฑุงุช ุงูุตูุญุฉ ุงูุญุงููุฉ
    function getCurrentPageNotifications() {
        const startIndex = (notificationsCurrentPage - 1) * notificationsPerPage;
        const endIndex = startIndex + notificationsPerPage;
        return filteredNotifications.slice(startIndex, endIndex);
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุชุญุฏูุฏ ุงููู
    function updateSelectAllCheckbox() {
        const checkboxes = document.querySelectorAll('.notification-checkbox');
        const allChecked = checkboxes.length > 0 && 
            Array.from(checkboxes).every(cb => cb.checked);
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุงูุชุฑุญูู
    function updateNotificationsPagination() {
        const totalPages = Math.ceil(filteredNotifications.length / notificationsPerPage);
        
        document.querySelector('.current-page').textContent = notificationsCurrentPage;
        document.querySelector('.total-pages').textContent = totalPages;
        
        const prevBtn = document.getElementById('prevNotificationsBtn');
        const nextBtn = document.getElementById('nextNotificationsBtn');
        
        if (prevBtn) prevBtn.disabled = notificationsCurrentPage === 1;
        if (nextBtn) nextBtn.disabled = notificationsCurrentPage === totalPages || totalPages === 0;
    }
    
    // ุฏุงูุฉ ุชุญุฏูุซ ุงูุฅุดุนุงุฑุงุช ุงููููุฉ
    function updateImportantNotifications() {
        const importantList = document.getElementById('importantList');
        if (!importantList) return;
        
        const importantNotifications = notifications.filter(n => n.important).slice(0, 5);
        
        if (importantNotifications.length === 0) {
            importantList.innerHTML = `
                <div class="no-important">
                    <i class="fas fa-star"></i>
                    <p>ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช ูููุฉ</p>
                </div>
            `;
            return;
        }
        
        let html = '';
        
        importantNotifications.forEach(notification => {
            const timeAgo = getTimeAgo(new Date(notification.date));
            
            html += `
                <div class="important-item" data-id="${notification.id}">
                    <div class="important-icon">
                        ${getNotificationIcon(notification.type)}
                    </div>
                    <div class="important-content">
                        <h5>${notification.title}</h5>
                        <p>${notification.message.substring(0, 50)}...</p>
                        <small>${timeAgo}</small>
                    </div>
                    <button class="btn-remove-important" data-id="${notification.id}">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
        });
        
        importantList.innerHTML = html;
        
        // ุฅุถุงูุฉ ุฃุญุฏุงุซ ูุฃุฒุฑุงุฑ ุงูุฅุฒุงูุฉ
        document.querySelectorAll('.btn-remove-important').forEach(btn => {
            btn.addEventListener('click', function() {
                const notificationId = parseInt(this.getAttribute('data-id'));
                toggleNotificationImportance(notificationId);
            });
        });
    }
    
    // ุฏุงูุฉ ุชุญุฏูุฏ ุฅุดุนุงุฑ ูููุฑูุก
    function markNotificationAsRead(notificationId) {
        const notification = notifications.find(n => n.id === notificationId);
        if (notification) {
            notification.read = true;
            saveData();
            loadNotifications();
            updateNotificationsStats();
            updateSidebarNotificationCount();
            
            showAlert('ุชู', 'ุชู ุชุญุฏูุฏ ุงูุฅุดุนุงุฑ ูููุฑูุก', true);
        }
    }
    
    // ุฏุงูุฉ ุชุญุฏูุฏ ุงููู ูููุฑูุก
    function markAllAsRead() {
        if (filteredNotifications.length === 0) {
            showAlert('ูุนูููุฉ', 'ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช', false);
            return;
        }
        
        filteredNotifications.forEach(notification => {
            const originalNotification = notifications.find(n => n.id === notification.id);
            if (originalNotification) {
                originalNotification.read = true;
            }
        });
        
        saveData();
        loadNotifications();
        updateNotificationsStats();
        updateSidebarNotificationCount();
        
        showAlert('ุชู', 'ุชู ุชุญุฏูุฏ ุฌููุน ุงูุฅุดุนุงุฑุงุช ูููุฑูุก', true);
    }
    
    // ุฏุงูุฉ ุชุจุฏูู ุฃูููุฉ ุงูุฅุดุนุงุฑ
    function toggleNotificationImportance(notificationId) {
        const notification = notifications.find(n => n.id === notificationId);
        if (notification) {
            notification.important = !notification.important;
            saveData();
            loadNotifications();
            updateImportantNotifications();
            
            const message = notification.important ? 
                'ุชู ุชูููุฒ ุงูุฅุดุนุงุฑ ูููู' : 
                'ุชู ุฅูุบุงุก ุชูููุฒ ุงูุฅุดุนุงุฑ';
            showAlert('ุชู', message, true);
        }
    }
    
    // ุฏุงูุฉ ุญุฐู ุฅุดุนุงุฑ
    function deleteNotification(notificationId) {
        if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุฅุดุนุงุฑุ')) {
            const index = notifications.findIndex(n => n.id === notificationId);
            if (index !== -1) {
                notifications.splice(index, 1);
                saveData();
                loadNotifications();
                updateNotificationsStats();
                updateSidebarNotificationCount();
                
                showAlert('ุชู', 'ุชู ุญุฐู ุงูุฅุดุนุงุฑ', true);
            }
        }
    }
    
    // ุฏุงูุฉ ุญุฐู ุงููู
    function deleteAllNotifications() {
        if (filteredNotifications.length === 0) {
            showAlert('ูุนูููุฉ', 'ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช', false);
            return;
        }
        
        if (confirm(`ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุฌููุน ุงูุฅุดุนุงุฑุงุช (${filteredNotifications.length})ุ`)) {
            // ุญุฐู ุงูุฅุดุนุงุฑุงุช ุงููุตูุงุฉ ููุท
            filteredNotifications.forEach(filteredNotification => {
                const index = notifications.findIndex(n => n.id === filteredNotification.id);
                if (index !== -1) {
                    notifications.splice(index, 1);
                }
            });
            
            saveData();
            loadNotifications();
            updateNotificationsStats();
            updateSidebarNotificationCount();
            
            showAlert('ุชู', 'ุชู ุญุฐู ุฌููุน ุงูุฅุดุนุงุฑุงุช', true);
        }
    }
    
    // ุฏุงูุฉ ูุณุญ ุฌููุน ุงูุฅุดุนุงุฑุงุช ุงููููุฉ
    function clearAllImportant() {
        const importantNotifications = notifications.filter(n => n.important);
        
        if (importantNotifications.length === 0) {
            showAlert('ูุนูููุฉ', 'ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช ูููุฉ', false);
            return;
        }
        
        if (confirm(`ูู ุฃูุช ูุชุฃูุฏ ูู ุฅูุบุงุก ุชูููุฒ ุฌููุน ุงูุฅุดุนุงุฑุงุช ุงููููุฉ (${importantNotifications.length})ุ`)) {
            importantNotifications.forEach(notification => {
                notification.important = false;
            });
            
            saveData();
            loadNotifications();
            updateImportantNotifications();
            
            showAlert('ุชู', 'ุชู ุฅูุบุงุก ุชูููุฒ ุฌููุน ุงูุฅุดุนุงุฑุงุช ุงููููุฉ', true);
        }
    }
    
    // ุฏุงูุฉ ุนุฑุถ ุชูุงุตูู ุงูุฅุดุนุงุฑ
    function viewNotificationDetails(notificationId) {
        const notification = notifications.find(n => n.id === notificationId);
        if (!notification) return;
        
        // ุชุญุฏูุซ ูููุฑุงุกุฉ ุฅุฐุง ูู ููู ููุฑูุกุงู
if (!notification.read) {
notification.read = true;
saveData();
updateNotificationsStats();
updateSidebarNotificationCount();
}
    // ุชุนุจุฆุฉ ุงูุจูุงูุงุช ูู ุงููููุฐุฌ
    document.getElementById('notificationDetailsTitle').textContent = notification.title;
    
    const notificationDate = new Date(notification.date);
    const formattedDate = notificationDate.toLocaleDateString('ar-EG', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
    
    const detailsHtml = `
        <div class="notification-detail-header">
            <div class="detail-icon ${notification.type}">
                ${getNotificationIcon(notification.type)}
            </div>
            <div class="detail-info">
                <h4>${notification.title}</h4>
                <div class="detail-meta">
                    <span class="detail-type ${notification.type}">
                        ${getNotificationTypeText(notification.type)}
                    </span>
                    <span class="detail-time">
                        <i class="fas fa-clock"></i> ${formattedDate}
                    </span>
                    ${notification.important ? '<span class="detail-important"><i class="fas fa-star"></i> ููู</span>' : ''}
                </div>
            </div>
        </div>
        
        <div class="notification-detail-body">
            <div class="detail-message">
                <h5>ุงูุฑุณุงูุฉ:</h5>
                <p>${notification.message}</p>
            </div>
            
            ${notification.details ? `
                <div class="detail-additional">
                    <h5>ุชูุงุตูู ุฅุถุงููุฉ:</h5>
                    <p>${notification.details}</p>
                </div>
            ` : ''}
            
            ${notification.user ? `
                <div class="detail-related-user">
                    <h5>ุงููุณุชุฎุฏู ุงููุฑุชุจุท:</h5>
                    <div class="user-info">
                        <span>${notification.user}</span>
                        ${notification.memberId ? `<small>ููุฏ: ${notification.memberId}</small>` : ''}
                    </div>
                </div>
            ` : ''}
        </div>
        
        <div class="notification-detail-footer">
            <div class="detail-actions">
                <button class="btn-secondary" onclick="toggleNotificationImportance(${notification.id}); closeModal('notificationDetailsModal');">
                    <i class="fas fa-${notification.important ? 'star' : 'star'}"></i>
                    ${notification.important ? 'ุฅูุบุงุก ุงูุชูููุฒ' : 'ุชูููุฒ ูููู'}
                </button>
                <button class="btn-danger" onclick="deleteNotification(${notification.id}); closeModal('notificationDetailsModal');">
                    <i class="fas fa-trash"></i> ุญุฐู
                </button>
            </div>
        </div>
    `;
    
    document.getElementById('notificationDetailsContent').innerHTML = detailsHtml;
    
    // ูุชุญ ุงููููุฐุฌ
    openModal('notificationDetailsModal');
}

// ุฏุงูุฉ ุชุญููู ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช
function loadNotificationSettings() {
    const settings = JSON.parse(localStorage.getItem('notificationSettings')) || {};
    
    // ุชุนููู ุงูููู ุงูุงูุชุฑุงุถูุฉ
    document.getElementById('notifyNewMembers').checked = settings.notifyNewMembers !== false;
    document.getElementById('notifyRenewals').checked = settings.notifyRenewals !== false;
    document.getElementById('notifyExpired').checked = settings.notifyExpired !== false;
    document.getElementById('notifyExpiring').checked = settings.notifyExpiring !== false;
    document.getElementById('notifyPayments').checked = settings.notifyPayments !== false;
    document.getElementById('methodInApp').checked = settings.methodInApp !== false;
    document.getElementById('methodEmail').checked = settings.methodEmail || false;
    document.getElementById('methodSMS').checked = settings.methodSMS || false;
    document.getElementById('notificationSound').value = settings.notificationSound || 'default';
}

// ุฏุงูุฉ ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช
function saveNotificationSettings(e) {
    e.preventDefault();
    
    const settings = {
        notifyNewMembers: document.getElementById('notifyNewMembers').checked,
        notifyRenewals: document.getElementById('notifyRenewals').checked,
        notifyExpired: document.getElementById('notifyExpired').checked,
        notifyExpiring: document.getElementById('notifyExpiring').checked,
        notifyPayments: document.getElementById('notifyPayments').checked,
        methodInApp: document.getElementById('methodInApp').checked,
        methodEmail: document.getElementById('methodEmail').checked,
        methodSMS: document.getElementById('methodSMS').checked,
        notificationSound: document.getElementById('notificationSound').value
    };
    
    localStorage.setItem('notificationSettings', JSON.stringify(settings));
    
    closeModal('notificationSettingsModal');
    showAlert('ุชู ุงูุญูุธ', 'ุชู ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช ุจูุฌุงุญ', true);
}

// ุฏุงูุฉ ุชุตุฏูุฑ ุงูุฅุดุนุงุฑุงุช
function exportNotifications() {
    const exportData = filteredNotifications.map(notification => ({
        'ุงูุนููุงู': notification.title,
        'ุงูุฑุณุงูุฉ': notification.message,
        'ุงูููุน': getNotificationTypeText(notification.type),
        'ุงูุชุงุฑูุฎ': notification.date,
        'ุงูุญุงูุฉ': notification.read ? 'ููุฑูุก' : 'ุบูุฑ ููุฑูุก',
        'ุงูุฃูููุฉ': notification.important ? 'ููู' : 'ุนุงุฏู'
    }));
    
    const dataStr = JSON.stringify(exportData, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
    
    const exportFileName = `ุงูุฅุดุนุงุฑุงุช_${new Date().toISOString().split('T')[0]}.json`;
    
    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileName);
    document.body.appendChild(linkElement);
    linkElement.click();
    document.body.removeChild(linkElement);
    
    showAlert('ุชู ุงูุชุตุฏูุฑ', 'ุชู ุชุตุฏูุฑ ุงูุฅุดุนุงุฑุงุช ุจูุฌุงุญ', true);
}

</script>

</body> 
</html>